library(factoextra)
library(FactoMineR)
library(ggplot2)
library(viridis)

clus <- read.csv(file="completekmc.csv", header = TRUE)
clus$ClusterNumber <- as.factor(clus$ClusterNumber)
clus$Season <- as.factor(clus$Season)

gen.pca <- PCA(clus[,1:25], graph = FALSE)
fviz_pca_var(gen.pca, col.var="contrib",
             repel = TRUE,
             max.overlaps = 1) +
  scale_color_viridis(end = 0.9,
    option = "A")

fviz_contrib(gen.pca, 
             choice = "var", 
             axes = 1, 
             top = 25, 
             fill = "Grey") +
  ggtitle(label = "Contributions to the First Principle Component")

fviz_contrib(gen.pca, 
             choice = "var", 
             axes = 2, 
             top = 25, 
             fill = "Grey") +
  ggtitle(label = "Contributions to the Second Principle Component")

sc.pca <- PCA(clus[,1:25], graph = FALSE)
sc <- as.data.frame(sc.pca$x)
sc <- sc[-c(508, 509), ]

ggplot(sc) + 
  geom_point(aes(x=PC1, y=PC2, 
                 shape = Season, 
                 color = ClusterNumber), 
             size=1.5, 
             show.legend = TRUE) +
  geom_mark_ellipse(aes(x = PC1, y = PC2, 
                        fill = Season, 
                        label = Season),
                    colour = "black",
                    show.legend = FALSE) +
  scale_color_viridis(begin = 0.1,
                      end = 0.9,
                      discrete = TRUE,
                      option = "A") +
  theme(legend.position = 'none') +
  xlab("First Principle Component") +
  ylab("Second Principle Component") +
  theme_classic()

library(corrplot)
corr <- read.csv(file = "clustercorr.csv", header = TRUE)
M <- cor(corr)
col1 <- colorRampPalette(magma(n = 100))
corrplot(M, method = "color", 
         order = "hclust", 
         addrect = 3, 
         col = colorRampPalette(magma(n=10))(100), 
         addCoef.col = "BLACK")
